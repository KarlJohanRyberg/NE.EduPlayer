if(null===NE||void 0===NE)var NE={};(null===NE.Plugin||void 0===NE.Plugin)&&(NE.Plugin={}),NE.Plugin.chapter=function(i_params){function _addToDOM(i_content){_params.node.replaceWith(i_content),i_content.first().attr("id",NE.Constants.CHAPTER_ID_PREFIX+_settings.index)}function _pageOnLoad(e){e.chapter==_settings.index&&(me.LoadedPages++,me.LoadedPages==_settings.chapter.pages.length&&me.OnLoaded({guid:NE.CourseTree.chapters[_settings.index].guid,index:_settings.index}))}var _myDOMContent,_params=i_params,_settings={},me={Name:"chapter",LoadedPages:0,Dependencies:["chapter.css"],Init:function(){_settings=_params.settings,NE.Plugin.ApplyTemplate(this,function(data){_myDOMContent=$(data),_addToDOM(_myDOMContent),NE.Plugin.LoadAll(_myDOMContent.first(),_pageOnLoad)})},AddPages:function(){for(var returnVal="",i=0;i<_settings.chapter.pages.length;i++){var page=NE.CourseTree.chapters[_settings.index].pages[i],dataFile=page.datafile;if(-1!=dataFile.indexOf("|")){var alts=dataFile.split("|");dataFile=alts[Math.round(Math.random()*(alts.length-1))]}var contentFile=NE.Constants.CONTENT_BASE_PATH+"/content/data/"+dataFile+".html";page.chapterIndex=_settings.index,page.index=i,page.datafile=contentFile,page.initclasses="NE-scroll-watched",returnVal+='<div class="NE-plugin-container" data-plugin="page" data-settings="'+escape(JSON.stringify(page))+'"></div>'}return returnVal},OnLoaded:function(){},eof:null};return me};